project: devpack-for-spring

backends:
  lxd:
    systems:
      - ubuntu-24.04
      - ubuntu-22.04
      - ubuntu-20.04

path: /home/test

suites:
  tests/spread/:
    summary: integration tests

prepare: |
  set -ex
  apt update
  apt install -y retry
  # install local devpack
  for x in `find devpack-for-spring -name *.snap -print`; do
    retry --times=10 --delay 2 -- snap install --dangerous --classic $x
  done
  # check that it pulled the manifest from the snap store
  snap info devpack-for-spring-manifest | grep "installed:"
  # install local manifest
  find devpack-for-spring-manifest -name *.snap -exec snap install --dangerous --classic {} \;
  # install openjdk
  apt update
  apt install -y openjdk-21-jdk
